import "dotnet"
rule NetptuneMAPIBackdoor {
	meta:
		type = "malware"
		description = "NetptuneMAPIBackdoor"
		author = "labs@alienvault.com"
	strings:
		$pdb = "SmsServiceServerTest.pdb"
		$key = "2E4B7C022329E5C21E47D55E8916F6AF852AABBBD1798F9E16985F22A8056646"
		$st2 = "CampaignData"
		$st3 = "campaiginData"
		$st4 = "HttpBindingBase"
		$st5 = "set_UseShellExecute"
		$st6 = "sendSMSFlash"
		$st7 = "not uploaded" wide ascii
	condition:
		uint16(0) == 0x5A4D and 
		((dotnet.typelib == "a7d94843-0bdf-4675-9735-bf75857331fb" and 
		dotnet.guids[0] == "2945c3c4-1b62-4cfc-b902-1f639fa79fc5") or $pdb or $key or all of ($st*))
}
rule alienvault_webshells_asp Webshells{
	meta:
		author = "AlienVault Labs"
		info = "Generic detections for possible PHP Web-Shells"
	strings:
		$sa = "<%eval request(" wide ascii nocase
		$sb = "Server.CreateObject(\"WSCRIPT.SHELL\")"
		$sc = "Eval(Request(" wide ascii nocase
		$sd = "ExecuteGlobal(StrReverse" wide ascii nocase
		$se = "<%eval(Request.Item[" wide ascii nocase
	condition:
		any of them
}